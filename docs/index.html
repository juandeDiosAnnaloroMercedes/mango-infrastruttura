<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mango ‚Äî Infrastruttura di fiducia locale</title>

  <style>
    :root{
      --bg:#0b0b0c;
      --card:#121214;
      --text:#ffffff;
      --muted:#b8b8b8;
      --line:#2a2a2f;
      --accent:#2d6cdf;
      --accent2:#22c55e;
      --danger:#ef4444;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.35;
    }
    a{color:inherit}
    .wrap{
      max-width:980px;
      margin:0 auto;
      padding:20px 16px 40px;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 0 18px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:800;
      letter-spacing:0.2px;
      font-size:18px;
    }
    .brand .emoji{font-size:22px}
    .langbar{
      display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;
    }
    .chip{
      border:1px solid var(--line);
      background:transparent;
      color:var(--text);
      padding:8px 10px;
      border-radius:999px;
      font-size:13px;
      cursor:pointer;
    }
    .chip.active{
      border-color:var(--accent);
      box-shadow:0 0 0 2px rgba(45,108,223,.18) inset;
    }

    .hero{
      background:linear-gradient(180deg, rgba(45,108,223,.18), rgba(45,108,223,.05));
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:18px 16px;
      margin-bottom:14px;
    }
    .hero h1{
      margin:0 0 8px;
      font-size:28px;
      line-height:1.15;
    }
    .hero p{
      margin:0;
      color:var(--muted);
      font-size:15px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    @media (min-width: 860px){
      .grid{ grid-template-columns: 1fr 1fr; }
      .full{ grid-column: 1 / -1; }
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:16px;
    }
    .card h2{
      margin:0 0 10px;
      font-size:18px;
    }
    .card p, .card li{
      color:var(--muted);
      font-size:14px;
    }
    .card ul{margin:10px 0 0; padding-left:18px}

    .btnrow{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px}
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid var(--line);
      background:transparent;
      color:var(--text);
      font-weight:700;
      font-size:14px;
      text-decoration:none;
      cursor:pointer;
    }
    .btn.primary{
      background:var(--accent);
      border-color:transparent;
    }
    .btn.good{
      background:rgba(34,197,94,.16);
      border-color:rgba(34,197,94,.35);
    }
    .btn.danger{
      background:rgba(239,68,68,.12);
      border-color:rgba(239,68,68,.35);
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top:10px;
    }
    textarea{
      width:100%;
      min-height:110px;
      resize:vertical;
      border-radius:14px;
      border:1px solid var(--line);
      background:#0e0e10;
      color:var(--text);
      padding:12px;
      font-size:14px;
      outline:none;
    }
    textarea:focus{border-color:rgba(45,108,223,.65)}
    .meta{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-top:8px;
      color:var(--muted);
      font-size:13px;
    }
    .status{
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#0e0e10;
      color:var(--muted);
      font-size:13px;
      display:none;
    }
    .status.show{display:block}
    footer{
      margin-top:18px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
    }
    .smallnote{font-size:12px; color:var(--muted); margin-top:8px}
    .divider{height:1px;background:var(--line);margin:12px 0}

    /* Toast (verde/rosso) */
    .toast{
      position:fixed;
      left:50%;
      bottom:22px;
      transform:translateX(-50%);
      z-index:9999;
      padding:12px 14px;
      border-radius:16px;
      font-weight:900;
      box-shadow:0 10px 24px rgba(0,0,0,.22);
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease, transform .18s ease;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(17,17,17,.92);
      color:#fff;
    }
    .toast.show{
      opacity:1;
      transform:translateX(-50%) translateY(-4px);
    }
    .toast.good{
      background:rgba(34,197,94,.18);
      border-color:rgba(34,197,94,.35);
      color:#eafff2;
    }
    .toast.warn{
      background:rgba(239,68,68,.16);
      border-color:rgba(239,68,68,.35);
      color:#ffecec;
    }
  </style>
</head>

<body>




<div class="wrap">
  

    <header>
      <div class="brand">
  <a href="./Bianco.html" style="text-decoration:none;">
    <span class="emoji">ü•≠</span>
  </a>
  <span id="brandTitle">Mango</span>
</div>


      <div class="langbar" aria-label="Language selector">
        <button class="chip" data-lang="it">IT</button>
        <button class="chip" data-lang="en">EN</button>
        <button class="chip" data-lang="es">ES</button>
        <button class="chip" data-lang="fr">FR</button>
        <button class="chip" data-lang="de">DE</button>
        <button class="chip" data-lang="zh">‰∏≠Êñá</button>
      </div>
    </header>

    <section class="hero">
      <h1 id="heroTitle">Mango ‚Äî infrastruttura di fiducia locale</h1>
      <p id="heroSub">
        Non monetaria, non appropriabile, anti-accumulo, anti-cattura. Nata il 02 febbraio 2026.
      </p>
    </section>

    <section class="grid">
      <!-- 1) FAI MANGO ADESSO -->
      <div class="card">
        <h2 id="sec1Title">Fai Mango adesso</h2>
        <p id="sec1Text">
        Mango nasce da scambi reali tra persone. Non √® denaro. Non si conta. Non si accumula.
</p>

<p style="margin-top:8px; font-weight:700;">
  Scrivi una riga. √à gi√† Mango ü•≠
</p>
    
        
        
        <div class="btnrow">
          <a class="btn primary" id="btnPrimoScambio" href="#scrivi">ü•≠ <span id="btnPrimoScambioTxt">Fai il primo scambio</span></a>
          <a class="btn" id="btnFAQ" href="faq.html">‚ùì <span id="btnFAQTxt">FAQ</span></a>
        </div>
        <div class="smallnote" id="sec1Note" style="display:none"></div>
      </div>

      <!-- 2) SCRIVI UNA RIGA -->
      <div class="card" id="scrivi">
        <h2 id="sec2Title">Scrivi una riga</h2>
        <p id="sec2Text">
          Una riga = riconoscimento di uno scambio reale. Nessun numero, nessun valore.
        </p>

        <div class="field">
          <label for="riga" id="rigaLabel" style="color:var(--muted); font-size:13px;">
            Descrivi lo scambio (breve, umano, chiaro):
          </label>
          <textarea id="riga" placeholder="Es: Ho aiutato a portare la spesa; in cambio ho ricevuto un passaggio."></textarea>

          <div class="btnrow">
            <button class="btn good" id="btnInvia" type="button">üì© <span id="btnInviaTxt">Invia / Salva</span></button>
            <button class="btn danger" id="btnPulisci" type="button">üßπ <span id="btnPulisciTxt">Pulisci</span></button>
          </div>

          <div class="meta">
            <div id="metaCount">0 righe salvate su questo dispositivo</div>
            <div id="metaHint">Suggerimento: premi anche Invio (‚åÖ) per salvare.</div>
          </div>

          <div class="status" id="statusBox"></div>
        </div>

        <div class="divider"></div>
        <div class="btnrow">
          <button class="btn" id="btnApriArchivio" type="button">üìö <span id="btnApriArchivioTxt">Vedi righe salvate</span></button>
          <button class="btn danger" id="btnSvuotaArchivio" type="button">üóëÔ∏è <span id="btnSvuotaArchivioTxt">Svuota archivio</span></button>
        </div>
        <div class="smallnote" id="sec2Note">
          Salvataggio locale (telefono/PC). Se vuoi anche invio online, serve un backend o un form esterno.
        </div>
      </div>

      <!-- 3) COS'√à MANGO -->
      <div class="card full">
        <h2 id="sec3Title">Cos‚Äô√® Mango</h2>
        <p id="sec3Text">
          Mango √® un‚Äôinfrastruttura di fiducia locale non monetaria: riconosce scambi reali senza trasformarli in quantit√†, valore o accumulo.
          Creato da Juan de Dios Annaloro Mercedes in memoria di sua sorella Larimar.
        </p>

        <div class="btnrow">
          <a class="btn primary" id="btnPDF" href="pdf/Mango_Documento_Fondativo_Multilingua_v1.pdf" target="_blank" rel="noopener">
            üìÑ <span id="btnPDFTxt">Documento Fondativo Ufficiale (Multilingua)</span>
          </a>
        </div>

<div class="btnrow">
  <a href="QR_MANGO_UFFICIALE.pdf"
     target="_blank"
     rel="noopener noreferrer external"
     class="btn">
     Stampa & QR
  </a>
</div>

<div class="smallnote" id="pdfNote">
<section id="muro-mango" class="muro">
  <h2>Muro Mango</h2>

  <div class="muro-grid">

    <div class="muro-box" lang="it">
      <div class="muro-lang">IT</div>
      <ul class="muro-list" data-lang="it"></ul>
    </div>

    <div class="muro-box" lang="en">
      <div class="muro-lang">EN</div>
      <ul class="muro-list" data-lang="en"></ul>
    </div>

    <div class="muro-box" lang="es">
      <div class="muro-lang">ES</div>
      <ul class="muro-list" data-lang="es"></ul>
    </div>

    <div class="muro-box" lang="fr">
      <div class="muro-lang">FR</div>
      <ul class="muro-list" data-lang="fr"></ul>
    </div>

    <div class="muro-box" lang="de">
      <div class="muro-lang">DE</div>
      <ul class="muro-list" data-lang="de"></ul>
    </div>

    <div class="muro-box" lang="zh-Hant">
      <div class="muro-lang">‰∏≠Êñá</div>
      <ul class="muro-list" data-lang="zh-Hant"></ul>

</div>
</section>
    <footer id="footerTxt">
      Mango ‚Äî nato il 02 febbraio 2026. Infrastruttura non monetaria, non appropriabile, anti-accumulo, anti-cattura.
    </footer>

  </div>

  <!-- Toast unico (cambia testo e colore) -->
  <div class="toast" id="toastBox">Riga riconosciuta</div>

  <script>
    const STR = {
      it: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî infrastruttura di fiducia locale",
        heroSub: "Non monetaria, non appropriabile, anti-accumulo, anti-cattura. Nata il 02 febbraio 2026.",
        sec1Title: "Fai Mango adesso",
        sec1Text: "Mango nasce da scambi reali tra persone. Non √® denaro. Non si conta. Non si accumula.",
        btnPrimoScambioTxt: "Fai il primo scambio",
        btnFAQTxt: "FAQ",
        sec2Title: "Scrivi una riga",
        sec2Text: "Una riga = riconoscimento di uno scambio reale. Nessun numero, nessun valore.",
        rigaLabel: "Descrivi lo scambio (breve, umano, chiaro):",
        rigaPh: "Es: Ho aiutato a portare la spesa; in cambio ho ricevuto un passaggio.",
        btnInviaTxt: "Invia / Salva",
        btnPulisciTxt: "Pulisci",
        metaHint: "Suggerimento: premi anche Invio (‚åÖ) per salvare.",
        btnApriArchivioTxt: "Vedi righe salvate",
        btnSvuotaArchivioTxt: "Svuota archivio",
        sec2Note: "Salvataggio locale (telefono/PC). Se vuoi anche invio online, serve un backend o un form esterno.",
        sec3Title: "Cos‚Äô√® Mango",
        sec3Text: "Mango √® un‚Äôinfrastruttura di fiducia locale non monetaria: riconosce scambi reali senza trasformarli in quantit√†, valore o accumulo. Creato da Juan de Dios Annaloro Mercedes in memoria di sua sorella Larimar.",
        btnPDFTxt: "Documento Fondativo Ufficiale (Multilingua)",
        footerTxt: "Mango ‚Äî nato il 02 febbraio 2026. Infrastruttura non monetaria, non appropriabile, anti-accumulo, anti-cattura.",
        savedOk: "Salvato ‚úÖ",
        savedEmpty: "Scrivi qualcosa prima di salvare.",
        cleared: "Campo pulito.",
        archiveEmpty: "Archivio vuoto (nessuna riga salvata su questo dispositivo).",
        confirmWipe: "Sicuro di voler cancellare TUTTE le righe salvate su questo dispositivo?",
        wiped: "Archivio cancellato.",
        toastOk: "Riga riconosciuta",
        warnNumbers: "‚ö†Ô∏è Mango non si conta. Cerca di rispettare te stesso."
      },
      en: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî local trust infrastructure",
        heroSub: "Non-monetary, non-appropriable, anti-accumulation, anti-capture. Born on 02 Feb 2026.",
        sec1Title: "Do Mango now",
        sec1Text: "Mango comes from real exchanges between people. It is not money. It is not counted. It is not accumulated.",
        btnPrimoScambioTxt: "Make the first exchange",
        btnFAQTxt: "FAQ",
        sec2Title: "Write one line",
        sec2Text: "One line = recognition of a real exchange. No numbers, no value.",
        rigaLabel: "Describe the exchange (short, human, clear):",
        rigaPh: "Example: I helped carry groceries; in return I got a ride.",
        btnInviaTxt: "Send / Save",
        btnPulisciTxt: "Clear",
        metaHint: "Tip: press Enter to save.",
        btnApriArchivioTxt: "View saved lines",
        btnSvuotaArchivioTxt: "Clear archive",
        sec2Note: "Local save (phone/PC). For online submission, you need a backend or an external form.",
        sec3Title: "What is Mango",
        sec3Text: "Mango is a non-monetary local trust infrastructure: it recognizes real exchanges without turning them into quantity, value, or accumulation. Created by Juan de Dios Annaloro Mercedes in memory of his sister Larimar.",
        btnPDFTxt: "Official Foundational Document (Multilingual)",
        footerTxt: "Mango ‚Äî born on 02 Feb 2026. Non-monetary, non-appropriable, anti-accumulation, anti-capture.",
        savedOk: "Saved ‚úÖ",
        savedEmpty: "Write something before saving.",
        cleared: "Cleared.",
        archiveEmpty: "Archive is empty (no lines saved on this device).",
        confirmWipe: "Are you sure you want to delete ALL saved lines on this device?",
        wiped: "Archive deleted.",
        toastOk: "Line recognized",
        warnNumbers: "‚ö†Ô∏è Mango is not counted. Try to respect yourself."
      },
      es: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî infraestructura local de confianza",
        heroSub: "No monetaria, no apropiable, anti-acumulaci√≥n, anti-captura. Nacida el 02 feb 2026.",
        sec1Title: "Haz Mango ahora",
        sec1Text: "Mango nace de intercambios reales entre personas. No es dinero. No se cuenta. No se acumula.",
        btnPrimoScambioTxt: "Hacer el primer intercambio",
        btnFAQTxt: "FAQ",
        sec2Title: "Escribe una l√≠nea",
        sec2Text: "Una l√≠nea = reconocimiento de un intercambio real. Sin n√∫meros, sin valor.",
        rigaLabel: "Describe el intercambio (breve, humano, claro):",
        rigaPh: "Ej: Ayud√© con la compra; a cambio recib√≠ un paseo.",
        btnInviaTxt: "Enviar / Guardar",
        btnPulisciTxt: "Limpiar",
        metaHint: "Consejo: pulsa Enter para guardar.",
        btnApriArchivioTxt: "Ver l√≠neas guardadas",
        btnSvuotaArchivioTxt: "Vaciar archivo",
        sec2Note: "Guardado local (tel√©fono/PC). Para enviar online necesitas backend o formulario externo.",
        sec3Title: "Qu√© es Mango",
        sec3Text: "Mango es una infraestructura local de confianza no monetaria: reconoce intercambios reales sin convertirlos en cantidad, valor o acumulaci√≥n. Creado por Juan de Dios Annaloro Mercedes en memoria de su hermana Larimar.",
        btnPDFTxt: "Documento Fundacional Oficial (Multiling√ºe)",
        footerTxt: "Mango ‚Äî nacido el 02 feb 2026. No monetario, no apropiable, anti-acumulaci√≥n, anti-captura.",
        savedOk: "Guardado ‚úÖ",
        savedEmpty: "Escribe algo antes de guardar.",
        cleared: "Limpio.",
        archiveEmpty: "Archivo vac√≠o (no hay l√≠neas guardadas en este dispositivo).",
        confirmWipe: "¬øSeguro que quieres borrar TODAS las l√≠neas guardadas en este dispositivo?",
        wiped: "Archivo borrado.",
        toastOk: "L√≠nea reconocida",
        warnNumbers: "‚ö†Ô∏è Mango no se cuenta. Intenta respetarte."
      },
      fr: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî infrastructure locale de confiance",
        heroSub: "Non mon√©taire, non appropriable, anti-accumulation, anti-capture. N√©e le 02 f√©v 2026.",
        sec1: "",
        sec1Title: "Fais Mango maintenant",
        sec1Text: "Mango na√Æt d‚Äô√©changes r√©els entre personnes. Ce n‚Äôest pas de l‚Äôargent. √áa ne se compte pas. √áa ne s‚Äôaccumule pas.",
        btnPrimoScambioTxt: "Faire le premier √©change",
        btnFAQTxt: "FAQ",
        sec2Title: "√âcris une ligne",
        sec2Text: "Une ligne = reconnaissance d‚Äôun √©change r√©el. Aucun chiffre, aucune valeur.",
        rigaLabel: "D√©cris l‚Äô√©change (court, humain, clair) :",
        rigaPh: "Ex : J‚Äôai aid√© √† porter les courses; en √©change j‚Äôai re√ßu un trajet.",
        btnInviaTxt: "Envoyer / Enregistrer",
        btnPulisciTxt: "Effacer",
        metaHint: "Astuce : appuie sur Entr√©e pour enregistrer.",
        btnApriArchivioTxt: "Voir les lignes enregistr√©es",
        btnSvuotaArchivioTxt: "Vider l‚Äôarchive",
        sec2Note: "Enregistrement local (t√©l√©phone/PC). Pour l‚Äôenvoi en ligne, il faut un backend ou un formulaire externe.",
        sec3Title: "Qu‚Äôest-ce que Mango",
        sec3Text: "Mango est une infrastructure locale de confiance non mon√©taire : elle reconna√Æt des √©changes r√©els sans les transformer en quantit√©, valeur ou accumulation. Cr√©√©e par Juan de Dios Annaloro Mercedes en m√©moire de sa s≈ìur Larimar.",
        btnPDFTxt: "Document Fondateur Officiel (Multilingue)",
        footerTxt: "Mango ‚Äî n√© le 02 f√©v 2026. Non mon√©taire, non appropriable, anti-accumulation, anti-capture.",
        savedOk: "Enregistr√© ‚úÖ",
        savedEmpty: "√âcris quelque chose avant d‚Äôenregistrer.",
        cleared: "Effac√©.",
        archiveEmpty: "Archive vide (aucune ligne enregistr√©e sur cet appareil).",
        confirmWipe: "Es-tu s√ªr de vouloir supprimer TOUTES les lignes enregistr√©es sur cet appareil ?",
        wiped: "Archive supprim√©e.",
        toastOk: "Ligne reconnue",
        warnNumbers: "‚ö†Ô∏è Mango ne se compte pas. Essaie de te respecter."
      },
      de: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî lokale Vertrauens-Infrastruktur",
        heroSub: "Nicht monet√§r, nicht aneignbar, anti-Akkumulation, anti-Capture. Geboren am 02. Feb 2026.",
        sec1Title: "Mach Mango jetzt",
        sec1Text: "Mango entsteht aus realen Austauschen zwischen Menschen. Es ist kein Geld. Es wird nicht gez√§hlt. Es wird nicht angesammelt.",
        btnPrimoScambioTxt: "Ersten Austausch machen",
        btnFAQTxt: "FAQ",
        sec2Title: "Schreibe eine Zeile",
        sec2Text: "Eine Zeile = Anerkennung eines realen Austauschs. Keine Zahlen, kein Wert.",
        rigaLabel: "Beschreibe den Austausch (kurz, menschlich, klar):",
        rigaPh: "Bsp: Ich half beim Tragen; im Gegenzug bekam ich eine Mitfahrt.",
        btnInviaTxt: "Senden / Speichern",
        btnPulisciTxt: "Leeren",
        metaHint: "Tipp: Dr√ºcke Enter zum Speichern.",
        btnApriArchivioTxt: "Gespeicherte Zeilen ansehen",
        btnSvuotaArchivioTxt: "Archiv leeren",
        sec2Note: "Lokales Speichern (Handy/PC). F√ºr Online-Senden brauchst du Backend oder externes Formular.",
        sec3Title: "Was ist Mango",
        sec3Text: "Mango ist eine nicht-monet√§re lokale Vertrauens-Infrastruktur: Sie erkennt reale Austausche an, ohne sie in Menge, Wert oder Akkumulation zu verwandeln. Erschaffen von Juan de Dios Annaloro Mercedes im Gedenken an seine Schwester Larimar.",
        btnPDFTxt: "Offizielles Gr√ºndungsdokument (Mehrsprachig)",
        footerTxt: "Mango ‚Äî geboren am 02. Feb 2026. Nicht monet√§r, nicht aneignbar, anti-Akkumulation, anti-Capture.",
        savedOk: "Gespeichert ‚úÖ",
        savedEmpty: "Schreibe etwas, bevor du speicherst.",
        cleared: "Geleert.",
        archiveEmpty: "Archiv ist leer (keine Zeilen auf diesem Ger√§t gespeichert).",
        confirmWipe: "Bist du sicher, dass du ALLE gespeicherten Zeilen auf diesem Ger√§t l√∂schen willst?",
        wiped: "Archiv gel√∂scht.",
        toastOk: "Zeile erkannt",
        warnNumbers: "‚ö†Ô∏è Mango wird nicht gez√§hlt. Respektiere dich selbst."
      },
      zh: {
        brandTitle: "Mango",
        heroTitle: "Mango ‚Äî Êú¨Âú∞‰ø°‰ªªÂü∫Á°ÄËÆæÊñΩ",
        heroSub: "ÈùûË¥ßÂ∏Å„ÄÅ‰∏çÂèØÂç†Êúâ„ÄÅÂèçÁßØÁ¥Ø„ÄÅÂèçÊú∫ÊûÑ‰øòËé∑„ÄÇËØûÁîü‰∫é 2026 Âπ¥ 2 Êúà 2 Êó•„ÄÇ",
        sec1Title: "Áé∞Âú®Â∞±ÂÅö Mango",
        sec1Text: "Mango Êù•Ëá™‰∫∫‰∏é‰∫∫‰πãÈó¥ÁúüÂÆû‰∫§Êç¢„ÄÇ‰∏çÊòØÈí±„ÄÇ‰∏çËÆ°Êï∞„ÄÇ‰∏çÁßØÁ¥Ø„ÄÇ",
        btnPrimoScambioTxt: "ËøõË°åÁ¨¨‰∏ÄÊ¨°‰∫§Êç¢",
        btnFAQTxt: "Â∏∏ËßÅÈóÆÈ¢ò",
        sec2Title: "ÂÜô‰∏ÄË°å",
        sec2Text: "‰∏ÄË°å = ÂØπ‰∏ÄÊ¨°ÁúüÂÆû‰∫§Êç¢ÁöÑËÆ§ÂèØ„ÄÇÊ≤°ÊúâÊï∞Â≠óÔºåÊ≤°Êúâ‰ª∑ÂÄº„ÄÇ",
        rigaLabel: "ÊèèËø∞ËøôÊ¨°‰∫§Êç¢ÔºàÁÆÄÁü≠„ÄÅ‰∫∫ÊÄß„ÄÅÊ∏ÖÊ•öÔºâÔºö",
        rigaPh: "‰æãÔºöÊàëÂ∏ÆÂøôÊèêËèúÔºõ‰Ωú‰∏∫‰∫§Êç¢ÊàëÂæóÂà∞‰∏ÄÊ¨°È°∫È£éËΩ¶„ÄÇ",
        btnInviaTxt: "Êèê‰∫§ / ‰øùÂ≠ò",
        btnPulisciTxt: "Ê∏ÖÁ©∫",
        metaHint: "ÊèêÁ§∫ÔºöÊåâÂõûËΩ¶‰πüÂèØ‰ª•‰øùÂ≠ò„ÄÇ",
        btnApriArchivioTxt: "Êü•ÁúãÂ∑≤‰øùÂ≠òÁöÑË°å",
        btnSvuotaArchivioTxt: "Ê∏ÖÁ©∫Â≠òÊ°£",
        sec2Note: "Êú¨Âú∞‰øùÂ≠òÔºàÊâãÊú∫/ÁîµËÑëÔºâ„ÄÇËã•Ë¶ÅÂú®Á∫øÊèê‰∫§ÔºåÈúÄË¶ÅÂêéÂè∞ÊàñÂ§ñÈÉ®Ë°®Âçï„ÄÇ",
        sec3Title: "‰ªÄ‰πàÊòØ Mango",
        sec3Text: "Mango ÊòØ‰∏ÄÁßçÈùûË¥ßÂ∏ÅÁöÑÊú¨Âú∞‰ø°‰ªªÂü∫Á°ÄËÆæÊñΩÔºöÂÆÉËÆ§ÂèØÁúüÂÆû‰∫§Êç¢Ôºå‰ΩÜ‰∏çÊääÂÆÉ‰ª¨ÂèòÊàêÊï∞Èáè„ÄÅ‰ª∑ÂÄºÊàñÁßØÁ¥Ø„ÄÇÁî± Juan de Dios Annaloro Mercedes ÂàõÂª∫Ôºå‰ª•Á∫™ÂøµÂÖ∂Â¶πÂ¶π Larimar„ÄÇ",
        btnPDFTxt: "ÂÆòÊñπÂ•†Âü∫Êñá‰ª∂ÔºàÂ§öËØ≠Ë®ÄÔºâ",
        footerTxt: "Mango ‚Äî ËØûÁîü‰∫é 2026 Âπ¥ 2 Êúà 2 Êó•„ÄÇÈùûË¥ßÂ∏Å„ÄÅ‰∏çÂèØÂç†Êúâ„ÄÅÂèçÁßØÁ¥Ø„ÄÅÂèçÊú∫ÊûÑ‰øòËé∑„ÄÇ",
        savedOk: "Â∑≤‰øùÂ≠ò ‚úÖ",
        savedEmpty: "ËØ∑ÂÖàÂÜôÁÇπÂÜÖÂÆπÂÜç‰øùÂ≠ò„ÄÇ",
        cleared: "Â∑≤Ê∏ÖÁ©∫„ÄÇ",
        archiveEmpty: "Â≠òÊ°£‰∏∫Á©∫ÔºàÊú¨ËÆæÂ§áÊú™‰øùÂ≠ò‰ªª‰ΩïËÆ∞ÂΩïÔºâ„ÄÇ",
        confirmWipe: "Á°ÆÂÆöË¶ÅÂà†Èô§Êú¨ËÆæÂ§á‰∏äÂ∑≤‰øùÂ≠òÁöÑÊâÄÊúâËÆ∞ÂΩïÂêóÔºü",
        wiped: "Â∑≤Âà†Èô§Â≠òÊ°£„ÄÇ",
        toastOk: "Â∑≤Á°ÆËÆ§Ëøô‰∏ÄË°å",
        warnNumbers: "‚ö†Ô∏è Mango ‰∏çËÆ°Êï∞„ÄÇËØ∑Â∞äÈáçËá™Â∑±„ÄÇ"
      }
    
    function getLang() {
      const url = new URL(window.location.href);
      const q = (url.searchParams.get("lang") || "").toLowerCase().trim();
      if (STR[q]) return q;
      return "it";
    }
    function setLang(lang) {
      const url = new URL(window.location.href);
      url.searchParams.set("lang", lang);
      window.location.href = url.toString();
    }

    function applyLang(lang) {
      document.documentElement.lang = lang === "zh" ? "zh" : lang;
      const s = STR[lang];

      const map = {
        brandTitle: "brandTitle",
        heroTitle: "heroTitle",
        heroSub: "heroSub",
        sec1Title: "sec1Title",
        sec1Text: "sec1Text",
        btnPrimoScambioTxt: "btnPrimoScambioTxt",
        btnFAQTxt: "btnFAQTxt",
        sec2Title: "sec2Title",
        sec2Text: "sec2Text",
        rigaLabel: "rigaLabel",
        btnInviaTxt: "btnInviaTxt",
        btnPulisciTxt: "btnPulisciTxt",
        metaHint: "metaHint",
        btnApriArchivioTxt: "btnApriArchivioTxt",
        btnSvuotaArchivioTxt: "btnSvuotaArchivioTxt",
        sec2Note: "sec2Note",
        sec3Title: "sec3Title",
        sec3Text: "sec3Text",
        btnPDFTxt: "btnPDFTxt",
        footerTxt: "footerTxt",
      };
      Object.entries(map).forEach(([k, id]) => {
        const el = document.getElementById(id);
        if (el) el.textContent = s[k];
      });

      const ta = document.getElementById("riga");
      if (ta) ta.placeholder = s.rigaPh;

      document.querySelectorAll(".chip").forEach(ch => {
        ch.classList.toggle("active", ch.dataset.lang === lang);
      });

      // imposta testo base toast (poi cambia al volo su ok/warn)
      const toast = document.getElementById("toastBox");
      if (toast) toast.textContent = s.toastOk;
    }

    // -----------------------------
    // Registro unico (MIGRAZIONE + DEDUP)
    // -----------------------------
    const STORAGE_KEY = "MANGO_REGISTRO_UNICO_V1";
    const OLD_KEYS = [
      "mango_righe_v1",
      "MANGO_RIGHE_V1",
      "mangoRighe",
      "righeMango",
      "MANGO_RIGHE",
      "registroMango",
      "MANGO_REGISTRO",
      "MANGO_RIGHE_HOME",
      "MANGO_RIGHE_PRIMO"
    ];

    function safeParse(raw){ try { return JSON.parse(raw); } catch { return null; } }
    function normalizeText(t){ return String(t ?? "").replace(/\s+/g," ").trim(); }

    function asRow(x){
      if (typeof x === "string") {
        const text = normalizeText(x);
        return text ? { text, ts: new Date().toISOString() } : null;
      }
      if (x && typeof x === "object") {
        const text = normalizeText(x.text ?? x.riga ?? x.value ?? "");
        if (!text) return null;
        const ts = typeof x.ts === "string" && x.ts ? x.ts : new Date().toISOString();
        return { text, ts };
      }
      return null;
    }

    function dedup(arr){
      const seen = new Set();
      const out = [];
      for (const r of arr){
        const k = r.text.toLowerCase();
        if (seen.has(k)) continue;
        seen.add(k);
        out.push(r);
      }
      return out;
    }

    function readKey(key){
      const raw = localStorage.getItem(key);
      if (!raw) return [];
      const parsed = safeParse(raw);
      if (!parsed || !Array.isArray(parsed)) return [];
      return parsed.map(asRow).filter(Boolean);
    }
    function writeKey(key, arr){
      localStorage.setItem(key, JSON.stringify(arr));
    }

    function migrateOnce(){
      if (localStorage.getItem(STORAGE_KEY)) return;
      let merged = [];
      for (const k of OLD_KEYS) merged = merged.concat(readKey(k));
      merged = dedup(merged).sort((a,b)=>(Date.parse(a.ts)||0)-(Date.parse(b.ts)||0));
      writeKey(STORAGE_KEY, merged);
    }

    function readArchive(){ migrateOnce(); return readKey(STORAGE_KEY); }
    function writeArchive(arr){ migrateOnce(); writeKey(STORAGE_KEY, arr); }

    function updateCount(lang){
      const n = readArchive().length;
      const el = document.getElementById("metaCount");
      if (!el) return;
      const t = {
        it: `${n} righe salvate su questo dispositivo`,
        en: `${n} lines saved on this device`,
        es: `${n} l√≠neas guardadas en este dispositivo`,
        fr: `${n} lignes enregistr√©es sur cet appareil`,
        de: `${n} Zeilen auf diesem Ger√§t gespeichert`,
        zh: `Êú¨ËÆæÂ§áÂ∑≤‰øùÂ≠ò ${n} Êù°ËÆ∞ÂΩï`
      };
      el.textContent = (t[lang] || t.it);
    }

    function showStatus(msg, tone){
      const box = document.getElementById("statusBox");
      if (!box) return;

      // reset
      box.style.borderColor = "";
      box.style.color = "";

      if (tone === "warn") {
        box.style.borderColor = "#ef4444";
        box.style.color = "#ef4444";
      }

      box.textContent = msg;
      box.classList.add("show");
      clearTimeout(window.__mangoStatusT);
      window.__mangoStatusT = setTimeout(() => box.classList.remove("show"), 3500);
    }

    function showToast(type, lang){
      const t = document.getElementById("toastBox");
      if (!t) return;

      t.classList.remove("good","warn");
      t.textContent = (type === "warn") ? STR[lang].warnNumbers : STR[lang].toastOk;
      t.classList.add(type === "warn" ? "warn" : "good");

      t.classList.add("show");
      clearTimeout(window.__mangoToastT);
      window.__mangoToastT = setTimeout(() => t.classList.remove("show"), 2400);
    }

    function saveLine(lang){
      const ta = document.getElementById("riga");
      if (!ta) return;

      const text = normalizeText(ta.value);
      if (!text){
        showStatus(STR[lang].savedEmpty);
        return;
      }

      // ‚ö†Ô∏è BLOCCO NUMERI (avviso rosso + toast rosso)
      if (/[0-9]/.test(text)){
        showStatus(STR[lang].warnNumbers, "warn");
        showToast("warn", lang);
        return; // non salva
      }

      const arr = readArchive();
      const merged = dedup([{ text, ts: new Date().toISOString() }, ...arr]);

      writeArchive(merged);
      ta.value = "";
      updateCount(lang);

      showStatus(STR[lang].savedOk);
      showToast("ok", lang); // toast verde
    }

    function openArchive(lang){
      const arr = readArchive();
      if (!arr.length){
        showStatus(STR[lang].archiveEmpty);
        return;
      }
      const lines = arr.slice(0,30)
        .map((x,i)=>`${i+1}. ${x.text}  (${new Date(x.ts).toLocaleString()})`)
        .join("\n\n");
      alert(lines + (arr.length>30 ? `\n\n‚Ä¶ +${arr.length-30}` : ""));
    }

    function wipeArchive(lang){
      if (!confirm(STR[lang].confirmWipe)) return;
      writeArchive([]);
      updateCount(lang);
      showStatus(STR[lang].wiped);
    }

    // Init
    const lang = getLang();
    applyLang(lang);
    updateCount(lang);

    document.querySelectorAll(".chip").forEach(ch=>{
      ch.addEventListener("click", ()=> setLang(ch.dataset.lang));
    });

    document.getElementById("btnInvia")?.addEventListener("click", ()=> saveLine(lang));
    document.getElementById("btnPulisci")?.addEventListener("click", ()=>{
      const ta = document.getElementById("riga");
      if (ta) ta.value = "";
      showStatus(STR[lang].cleared);
    });
    document.getElementById("btnApriArchivio")?.addEventListener("click", ()=> openArchive(lang));
    document.getElementById("btnSvuotaArchivio")?.addEventListener("click", ()=> wipeArchive(lang));

    document.getElementById("riga")?.addEventListener("keydown", (e)=>{
      if (
        (e.key === "Enter" && (e.ctrlKey || e.metaKey)) ||
        (e.key === "Enter" && e.shiftKey === false && (e.target.value || "").length > 0 && window.innerWidth > 700)
      ){
        e.preventDefault();
        saveLine(lang);
      }
    });
  </script>
  
<p style="text-align:center; font-size:0.9em;">
  <a href="mailto:press@mangoinfrastruttura.org">
    press@mangoinfrastruttura.org
  </a>
</p>
  <script src="muro-mango.js?v=FINAL-5"></script>
</body>
</html>
