<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mango</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="content">

    <nav style="margin-bottom:2rem;display:flex;gap:1rem;flex-wrap:wrap;">
      <a href="?lang=it">IT</a>
      <a href="?lang=en">EN</a>
      <a href="?lang=es">ES</a>
      <a href="?lang=fr">FR</a>
      <a href="?lang=de">DE</a>
      <a href="?lang=zh">中文</a>
    </nav>

    <section>
      <h1 data-i18n="title">Mango</h1>
      <p data-i18n="intro1"></p>
      <p data-i18n="intro2"></p>
    </section>

    <section>
      <h2 data-i18n="how_title"></h2>
      <p data-i18n="step1"></p>
      <p data-i18n="step2"></p>
      <p data-i18n="step3"></p>
      <p data-i18n="step4"></p>
    </section>

    <section>
      <h2 data-i18n="reg_title"></h2>
      <p data-i18n="reg_help"></p>

      <textarea id="lineInput" rows="3"
        style="width:100%;max-width:760px;padding:0.9rem;border:1px solid #ddd;border-radius:10px;"></textarea>

      <div style="margin-top:0.9rem;display:flex;gap:0.7rem;flex-wrap:wrap;">
        <button id="btnSave"></button>
        <button id="btnCopy"></button>
        <button id="btnExport"></button>
        <button id="btnImport"></button>
        <button id="btnClear"></button>
      </div>

      <input type="file" id="fileInput" accept=".txt" style="display:none;" />

      <pre id="registry"
        style="margin-top:1rem;white-space:pre-wrap;border:1px solid #eee;padding:1rem;border-radius:12px;background:#fafafa;"></pre>
    </section>

    <section style="margin-top:4rem;font-size:0.9rem;opacity:0.7;">
      <p data-i18n="creator"></p>
      <p data-i18n="memory"></p>
    </section>

  </main>

<script>
const SUPPORTED_LANGS=["it","en","es","fr","de","zh"];
const DEFAULT_LANG="it";
const STORAGE_KEY="mango_registry_lines_v2";

const translations={
it:{
title:"Mango",
intro1:"Mango riconosce uno scambio reale tra persone.",
intro2:"Non è una moneta. Non misura valore. Non accumula.",
how_title:"Come si fa Mango",
step1:"1. Avviene uno scambio reale tra persone.",
step2:"2. Si scrive una riga che riconosce che lo scambio è avvenuto.",
step3:"3. La riga non indica quantità, non crea credito o debito, non si accumula.",
step4:"Una riga è un Mango.",
reg_title:"Scrivi una riga",
reg_help:"Scrivi una riga semplice. Nessun numero, nessun valore.",
btnSave:"Salva riga",
btnCopy:"Copia registro",
btnExport:"Esporta .txt",
btnImport:"Importa .txt",
btnClear:"Cancella tutto",
creator:"Creato da Juan de Dios Annaloro Mercedes.",
memory:"In memoria di Larimar."
},
en:{
title:"Mango",
intro1:"Mango recognizes a real exchange between people.",
intro2:"It is not a currency. It does not measure value. It does not accumulate.",
how_title:"How to do Mango",
step1:"1. A real exchange happens between people.",
step2:"2. One line is written to acknowledge it.",
step3:"3. The line does not indicate quantities, creates no credit or debt, and does not accumulate.",
step4:"One line is one Mango.",
reg_title:"Write one line",
reg_help:"Write a simple line. No numbers, no value.",
btnSave:"Save line",
btnCopy:"Copy registry",
btnExport:"Export .txt",
btnImport:"Import .txt",
btnClear:"Clear all",
creator:"Created by Juan de Dios Annaloro Mercedes.",
memory:"In memory of Larimar."
},
es:{
title:"Mango",
intro1:"Mango reconoce un intercambio real entre personas.",
intro2:"No es una moneda. No mide el valor. No se acumula.",
how_title:"Cómo hacer Mango",
step1:"1. Ocurre un intercambio real entre personas.",
step2:"2. Se escribe una línea para reconocerlo.",
step3:"3. La línea no indica cantidades, no crea crédito ni deuda y no se acumula.",
step4:"Una línea es un Mango.",
reg_title:"Escribe una línea",
reg_help:"Escribe una línea simple. Sin números, sin valor.",
btnSave:"Guardar línea",
btnCopy:"Copiar registro",
btnExport:"Exportar .txt",
btnImport:"Importar .txt",
btnClear:"Borrar todo",
creator:"Creado por Juan de Dios Annaloro Mercedes.",
memory:"En memoria de Larimar."
},
fr:{
title:"Mango",
intro1:"Mango reconnaît un échange réel entre personnes.",
intro2:"Ce n’est pas une monnaie. Il ne mesure pas la valeur. Il ne s’accumule pas.",
how_title:"Comment faire Mango",
step1:"1. Un échange réel a lieu.",
step2:"2. Une ligne est écrite pour le reconnaître.",
step3:"3. La ligne n’indique aucune quantité, ne crée ni crédit ni dette et ne s’accumule pas.",
step4:"Une ligne est un Mango.",
reg_title:"Écris une ligne",
reg_help:"Écris une ligne simple. Pas de chiffres, pas de valeur.",
btnSave:"Enregistrer",
btnCopy:"Copier",
btnExport:"Exporter .txt",
btnImport:"Importer .txt",
btnClear:"Tout effacer",
creator:"Créé par Juan de Dios Annaloro Mercedes.",
memory:"En mémoire de Larimar."
},
de:{
title:"Mango",
intro1:"Mango erkennt einen realen Austausch an.",
intro2:"Es ist keine Währung. Es misst keinen Wert. Es sammelt sich nicht an.",
how_title:"Wie man Mango macht",
step1:"1. Ein realer Austausch findet statt.",
step2:"2. Eine Zeile wird geschrieben.",
step3:"3. Sie enthält keine Mengenangaben und sammelt sich nicht an.",
step4:"Eine Zeile ist ein Mango.",
reg_title:"Schreibe eine Zeile",
reg_help:"Eine einfache Zeile. Keine Zahlen, kein Wert.",
btnSave:"Speichern",
btnCopy:"Kopieren",
btnExport:"Exportieren .txt",
btnImport:"Importieren .txt",
btnClear:"Löschen",
creator:"Erstellt von Juan de Dios Annaloro Mercedes.",
memory:"Im Gedenken an Larimar."
},
zh:{
title:"Mango",
intro1:"Mango 用來承認真實的交換。",
intro2:"它不是貨幣，不衡量價值，也不可累積。",
how_title:"如何進行 Mango",
step1:"1. 發生真實的交換。",
step2:"2. 寫下一行來承認。",
step3:"3. 不表示數量，不產生信用或債務。",
step4:"一行就是一個 Mango。",
reg_title:"寫下一行",
reg_help:"寫下一行簡單文字。不要數字，不要價值。",
btnSave:"儲存",
btnCopy:"複製",
btnExport:"匯出 .txt",
btnImport:"匯入 .txt",
btnClear:"清除全部",
creator:"由 Juan de Dios Annaloro Mercedes 創建。",
memory:"為紀念 Larimar。"
}
};

function getLang(){
const p=new URLSearchParams(window.location.search);
const l=(p.get("lang")||"").toLowerCase();
return SUPPORTED_LANGS.includes(l)?l:DEFAULT_LANG;
}

function applyTranslations(){
const lang=getLang();
document.documentElement.setAttribute("lang",lang);
document.querySelectorAll("[data-i18n]").forEach(el=>{
const key=el.getAttribute("data-i18n");
el.textContent=translations[lang][key];
});
}

function loadRegistry(){
try{return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");}
catch{return[];}
}
function saveRegistry(arr){localStorage.setItem(STORAGE_KEY,JSON.stringify(arr));}
function render(arr){document.getElementById("registry").textContent=arr.join("\n");}

document.addEventListener("DOMContentLoaded",()=>{
applyTranslations();
let reg=loadRegistry();
render(reg);

document.getElementById("btnSave").onclick=()=>{
const v=lineInput.value.trim();
if(!v)return;
reg.push(v);
saveRegistry(reg);
render(reg);
lineInput.value="";
};

document.getElementById("btnCopy").onclick=()=>{
navigator.clipboard.writeText(reg.join("\n"));
};

document.getElementById("btnExport").onclick=()=>{
const blob=new Blob([reg.join("\n")],{type:"text/plain"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="mango_registro.txt";
a.click();
};

document.getElementById("btnImport").onclick=()=>{
document.getElementById("fileInput").click();
};

document.getElementById("fileInput").onchange=(e)=>{
const file=e.target.files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=()=>{
reg=reader.result.split("\n").filter(l=>l.trim()!=="");
saveRegistry(reg);
render(reg);
};
reader.readAsText(file);
};

document.getElementById("btnClear").onclick=()=>{
reg=[];
saveRegistry(reg);
render(reg);
};
});
</script>

</body>
</html>
