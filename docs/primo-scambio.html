<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Mango ‚Äî Primo scambio</title>

  <style>
    :root{
      --bg:#ffffff;
      --fg:#111111;
      --muted:#6b7280;
      --card:#f7f7f8;
      --border:#e5e7eb;
      --radius:18px;
      --shadow:0 10px 28px rgba(0,0,0,.06);
      --max:960px;
      --font:-apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--fg);
      background:var(--bg);
    }
    a{color:inherit;text-decoration:none}
    header{
      position:sticky; top:0; z-index:10;
      background:rgba(255,255,255,.9);
      backdrop-filter:saturate(180%) blur(10px);
      border-bottom:1px solid var(--border);
    }
    .hwrap{
      max-width:var(--max);
      margin:0 auto;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      font-size:22px;
      letter-spacing:-0.3px;
    }
    .mangoBtn{
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:6px 10px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      box-shadow:0 2px 10px rgba(0,0,0,.04);
      cursor:pointer;
    }
    .lang{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .chip{
      border:1px solid var(--border);
      background:#fff;
      border-radius:999px;
      padding:10px 14px;
      font-weight:800;
      cursor:pointer;
      min-width:52px;
      text-align:center;
    }
    .chip[aria-current="true"]{
      outline:2px solid #111;
      outline-offset:2px;
    }

    main{max-width:var(--max); margin:0 auto; padding:18px 16px 40px}
    .hero{
      margin-top:10px;
      color:var(--muted);
      line-height:1.6;
      font-size:16px;
    }

    .grid{
      display:grid;
      grid-template-columns:1fr;
      gap:16px;
      margin-top:14px;
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
    }
    .card h1{
      margin:0 0 10px;
      font-size:28px;
      line-height:1.15;
      letter-spacing:-0.6px;
    }
    .card h2{
      margin:0 0 10px;
      font-size:22px;
      letter-spacing:-0.3px;
    }
    .card p, .card li{
      margin:0;
      color:var(--fg);
      line-height:1.6;
      font-size:16px;
    }
    .muted{color:var(--muted)}
    ul{margin:10px 0 0 18px}
    li{margin:7px 0}
    hr{border:0;border-top:1px solid var(--border); margin:14px 0}

    textarea{
      width:100%;
      min-height:130px;
      resize:vertical;
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px;
      font-size:16px;
      outline:none;
      background:#fff;
    }
    .btnrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
      align-items:center;
    }
    .btn{
      border:0;
      background:#111;
      color:#fff;
      border-radius:14px;
      padding:12px 14px;
      font-weight:900;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn.secondary{
      background:#fff;
      color:#111;
      border:1px solid var(--border);
    }
    .btn.small{
      padding:10px 12px;
      border-radius:12px;
      font-weight:900;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:12px;
    }
    .lineItem{
      background:#fff;
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
    }
    .lineMeta{
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-bottom:8px;
    }
    .tag{
      font-size:12px;
      color:var(--muted);
      font-weight:800;
      letter-spacing:.2px;
    }
    .lineText{
      white-space:pre-wrap;
      font-size:16px;
      line-height:1.55;
    }
    footer{
      max-width:var(--max);
      margin:0 auto;
      padding:18px 16px 40px;
      color:var(--muted);
      text-align:center;
      font-size:13px;
      line-height:1.6;
    }
    .spacer{height:6px}
  </style>
</head>

<body>
  <header id="top">
    <div class="hwrap">
      <div class="brand">
        <span>Mango</span>
        <button class="mangoBtn" id="mangoTop" title="Top">ü•≠</button>
      </div>

      <nav class="lang" aria-label="Lingue">
        <button class="chip" data-lang="it">IT</button>
        <button class="chip" data-lang="en">EN</button>
        <button class="chip" data-lang="es">ES</button>
        <button class="chip" data-lang="fr">FR</button>
        <button class="chip" data-lang="de">DE</button>
        <button class="chip" data-lang="zh">ZH</button>
      </nav>
    </div>
  </header>

  <main>
    <div class="card">
      <h1 id="t_title"></h1>
      <p class="hero" id="t_subtitle"></p>
    </div>

    <section class="grid">
      <article class="card" id="how">
        <h2 id="t_how_title"></h2>
        <p id="t_how_text"></p>
        <ul>
          <li id="t_how_li1"></li>
          <li id="t_how_li2"></li>
          <li id="t_how_li3"></li>
          <li id="t_how_li4"></li>
        </ul>
        <hr />
        <p class="muted" id="t_how_note"></p>

        <div class="btnrow">
          <a class="btn secondary" id="btn_home" href="./index.html">üè† <span id="t_btn_home"></span></a>
          <button class="btn secondary" id="btn_top">‚¨ÜÔ∏è <span id="t_btn_top"></span></button>
        </div>
      </article>

      <article class="card" id="write">
        <h2 id="t_write_title"></h2>
        <p class="muted" id="t_write_text"></p>

        <div class="spacer"></div>
        <textarea id="lineInput" placeholder=""></textarea>

        <div class="btnrow">
          <button class="btn" id="btn_send_keep">‚úÖ <span id="t_btn_send_keep"></span></button>
          <button class="btn secondary" id="btn_clear_field">üßΩ <span id="t_btn_clear_field"></span></button>
          <button class="btn secondary" id="btn_copy_line">üìã <span id="t_btn_copy"></span></button>
        </div>

        <p class="muted" style="margin-top:10px" id="t_write_hint"></p>
      </article>

      <article class="card" id="yourlines">
        <h2 id="t_yourlines_title"></h2>
        <p class="muted" id="t_yourlines_text"></p>

        <div class="btnrow">
          <button class="btn secondary" id="btn_delete_all">üóëÔ∏è <span id="t_btn_delete_all"></span></button>
        </div>

        <div class="list" id="linesList"></div>
        <p class="muted" id="t_empty" style="display:none;margin-top:10px"></p>
      </article>
    </section>
  </main>

  <footer>
    <div id="t_footer1"></div>
    <div id="t_footer2"></div>
  </footer>

  <script>
    // CONFIG
    const SUPPORTED = ["it","en","es","fr","de","zh"];
    const DEFAULT_LANG = "it";
    const STORAGE_KEY = "mango_lines_v1"; // stesso concetto di index (solo locale)

    // TRANSLATIONS
    const T = {
      it:{
  subtitle:"Scrivi la tua prima riga reale.",
  how_title:"Come fare il primo scambio",
  how_text:"Mango inizia quando due persone...",
  how_li1:"Fai qualcosa di concreto...",
  how_li2:"Subito dopo scrivi una riga semplice.",
  how_li3:"Niente numeri, prezzi, quantit√†..."


        write_title:"Scrivi la riga",
        write_text:"Una riga umana, concreta, reale.",
        write_placeholder:"Esempio: Ioana ha ascoltato Marco. (Roma, 14 feb 2026)",
        write_hint:"Premi ‚ÄúInvia (resta sul sito)‚Äù per salvare questa riga SOLO su questo dispositivo. Poi puoi copiarla o cancellarla quando vuoi.",

        btn_send_keep:"Invia (resta sul sito)",
        btn_clear_field:"Cancella campo",
        btn_copy:"Copia",
        btn_delete_all:"Elimina tutte le righe",

        yourlines_title:"Le tue righe (solo su questo dispositivo)",
        yourlines_text:"Queste righe non sono pubbliche: sono salvate nel tuo browser.",
        empty:"Nessuna riga salvata ancora.",

        footer1:"Creato da Juan de Dios Annaloro Mercedes ‚Äî 02 febbraio 2026 ‚Äî In memoria di Larimar.",
        footer2:"Mango √® praticabile e trasmissibile, ma non possedibile n√© centralizzabile."
      },

      en:{
        title:"How to do the first exchange",
        subtitle:"Write your first real line. It stays only on this device (not online).",
        how_title:"How to do the first exchange",
        how_text:"Mango starts when two people recognize a real gesture.",
        how_li1:"Do something concrete (help, time, care, presence).",
        how_li2:"Right after, write one simple line about what happened.",
        how_li3:"No numbers, prices, quantities, equivalences.",
        how_li4:"If needed: first names, initials, nicknames.",
        how_note:"Mango does not turn exchange into credit or debt. It is written recognition.",
        btn_home:"Home",
        btn_top:"Back to top",

        write_title:"Write the line",
        write_text:"One human, concrete, real line.",
        write_placeholder:"Example: Ioana listened to Marco. (Rome, Feb 14 2026)",
        write_hint:"Press ‚ÄúSend (stays on site)‚Äù to save this line ONLY on this device. Copy or delete whenever you want.",

        btn_send_keep:"Send (stays on site)",
        btn_clear_field:"Clear field",
        btn_copy:"Copy",
        btn_delete_all:"Delete all lines",

        yourlines_title:"Your lines (only on this device)",
        yourlines_text:"These lines are not public: they are stored in your browser.",
        empty:"No saved lines yet.",

        footer1:"Created by Juan de Dios Annaloro Mercedes ‚Äî 02 Feb 2026 ‚Äî In memory of Larimar.",
        footer2:"Practicable and transmissible, but not ownable or centralizable."
      },

      es:{
        title:"C√≥mo hacer el primer intercambio",
        subtitle:"Escribe tu primera l√≠nea real. Se queda solo en este dispositivo (no en l√≠nea).",
        how_title:"C√≥mo hacer el primer intercambio",
        how_text:"Mango empieza cuando dos personas reconocen un gesto real.",
        how_li1:"Haz algo concreto (ayuda, tiempo, cuidado, presencia).",
        how_li2:"Justo despu√©s, escribe una l√≠nea simple sobre lo que ocurri√≥.",
        how_li3:"Sin n√∫meros, precios, cantidades, equivalencias.",
        how_li4:"Si hace falta: nombres, iniciales o apodos.",
        how_note:"Mango no convierte el intercambio en cr√©dito o deuda. Es reconocimiento escrito.",
        btn_home:"Inicio",
        btn_top:"Volver arriba",

        write_title:"Escribe la l√≠nea",
        write_text:"Una l√≠nea humana, concreta, real.",
        write_placeholder:"Ejemplo: Ioana escuch√≥ a Marco. (Roma, 14 feb 2026)",
        write_hint:"Pulsa ‚ÄúEnviar (se queda en el sitio)‚Äù para guardar la l√≠nea SOLO en este dispositivo. Puedes copiarla o borrarla cuando quieras.",

        btn_send_keep:"Enviar (se queda en el sitio)",
        btn_clear_field:"Borrar campo",
        btn_copy:"Copiar",
        btn_delete_all:"Eliminar todas las l√≠neas",

        yourlines_title:"Tus l√≠neas (solo en este dispositivo)",
        yourlines_text:"Estas l√≠neas no son p√∫blicas: se guardan en tu navegador.",
        empty:"A√∫n no hay l√≠neas guardadas.",

        footer1:"Creado por Juan de Dios Annaloro Mercedes ‚Äî 02 febrero 2026 ‚Äî En memoria de Larimar.",
        footer2:"Practicable y transmisible, pero no pose√≠ble ni centralizable."
      },

      fr:{
        title:"Comment faire le premier √©change",
        subtitle:"√âcris ta premi√®re ligne r√©elle. Elle reste seulement sur cet appareil (pas en ligne).",
        how_title:"Comment faire le premier √©change",
        how_text:"Mango commence quand deux personnes reconnaissent un geste r√©el.",
        how_li1:"Fais quelque chose de concret (aide, temps, soin, pr√©sence).",
        how_li2:"Juste apr√®s, √©cris une ligne simple sur ce qui s‚Äôest pass√©.",
        how_li3:"Pas de chiffres, prix, quantit√©s, √©quivalences.",
        how_li4:"Si besoin : pr√©noms, initiales, surnoms.",
        how_note:"Mango ne transforme pas l‚Äô√©change en cr√©dit ou dette. C‚Äôest une reconnaissance √©crite.",
        btn_home:"Accueil",
        btn_top:"Haut de page",

        write_title:"√âcris la ligne",
        write_text:"Une ligne humaine, concr√®te, r√©elle.",
        write_placeholder:"Exemple : Ioana a √©cout√© Marco. (Rome, 14 f√©v 2026)",
        write_hint:"Appuie sur ¬´ Envoyer (reste sur le site) ¬ª pour enregistrer UNIQUEMENT sur cet appareil. Copier ou supprimer quand tu veux.",

        btn_send_keep:"Envoyer (reste sur le site)",
        btn_clear_field:"Effacer le champ",
        btn_copy:"Copier",
        btn_delete_all:"Supprimer toutes les lignes",

        yourlines_title:"Tes lignes (uniquement sur cet appareil)",
        yourlines_text:"Ces lignes ne sont pas publiques : elles sont stock√©es dans ton navigateur.",
        empty:"Aucune ligne enregistr√©e pour l‚Äôinstant.",

        footer1:"Cr√©√© par Juan de Dios Annaloro Mercedes ‚Äî 02 f√©vrier 2026 ‚Äî En m√©moire de Larimar.",
        footer2:"Praticable et transmissible, mais non poss√©dable ni centralisable."
      },

      de:{
        title:"Wie man den ersten Austausch macht",
        subtitle:"Schreibe deine erste reale Zeile. Sie bleibt nur auf diesem Ger√§t (nicht online).",
        how_title:"Wie man den ersten Austausch macht",
        how_text:"Mango beginnt, wenn zwei Menschen eine reale Geste anerkennen.",
        how_li1:"Tu etwas Konkretes (Hilfe, Zeit, F√ºrsorge, Pr√§senz).",
        how_li2:"Direkt danach: schreibe eine einfache Zeile √ºber das, was passiert ist.",
        how_li3:"Keine Zahlen, Preise, Mengen, √Ñquivalenzen.",
        how_li4:"Falls n√∂tig: Vornamen, Initialen, Spitznamen.",
        how_note:"Mango macht aus Austausch keinen Kredit oder Schuld. Es ist schriftliche Anerkennung.",
        btn_home:"Start",
        btn_top:"Nach oben",

        write_title:"Schreibe die Zeile",
        write_text:"Eine menschliche, konkrete, reale Zeile.",
        write_placeholder:"Beispiel: Ioana h√∂rte Marco zu. (Rom, 14 Feb 2026)",
        write_hint:"Klicke ‚ÄûSenden (bleibt auf der Seite)‚Äú, um NUR auf diesem Ger√§t zu speichern. Dann kopieren oder l√∂schen, wann du willst.",

        btn_send_keep:"Senden (bleibt auf der Seite)",
        btn_clear_field:"Feld l√∂schen",
        btn_copy:"Kopieren",
        btn_delete_all:"Alle Zeilen l√∂schen",

        yourlines_title:"Deine Zeilen (nur auf diesem Ger√§t)",
        yourlines_text:"Diese Zeilen sind nicht √∂ffentlich: sie werden im Browser gespeichert.",
        empty:"Noch keine gespeicherten Zeilen.",

        footer1:"Erstellt von Juan de Dios Annaloro Mercedes ‚Äî 02. Feb 2026 ‚Äî In Erinnerung an Larimar.",
        footer2:"Praktizierbar und √ºbertragbar, aber nicht besitzbar oder zentralisierbar."
      },

      zh:{
        title:"Â¶Ç‰ΩïÂÆåÊàêÁ¨¨‰∏ÄÊ¨°‰∫§Êç¢",
        subtitle:"ÂÜô‰∏ã‰Ω†ÁöÑÁ¨¨‰∏ÄÊù°ÁúüÂÆûËÆ∞ÂΩï„ÄÇÂÆÉÂè™‰øùÂ≠òÂú®Êú¨ËÆæÂ§áÔºà‰∏çÂú®Á∫øÔºâ„ÄÇ",
        how_title:"Â¶Ç‰ΩïÂÆåÊàêÁ¨¨‰∏ÄÊ¨°‰∫§Êç¢",
        how_text:"ÂΩì‰∏§‰∏™‰∫∫ÊâøËÆ§‰∏Ä‰∏™ÁúüÂÆûÁöÑ‰∏æÂä®Êó∂ÔºåMango Â∞±ÂºÄÂßã‰∫Ü„ÄÇ",
        how_li1:"ÂÅö‰∏Ä‰ª∂ÂÖ∑‰ΩìÁöÑ‰∫ãÔºàÂ∏ÆÂä©„ÄÅÊó∂Èó¥„ÄÅÁÖßÈ°æ„ÄÅÈô™‰º¥Ôºâ„ÄÇ",
        how_li2:"Á¥ßÊé•ÁùÄÔºåÁî®‰∏ÄË°åÁÆÄÂçïÊñáÂ≠óÂÜô‰∏ãÂèëÁîü‰∫Ü‰ªÄ‰πà„ÄÇ",
        how_li3:"‰∏çË¶ÅÊï∞Â≠ó„ÄÅ‰ª∑Ê†º„ÄÅÊï∞Èáè„ÄÅÁ≠â‰ª∑Êç¢ÁÆó„ÄÇ",
        how_li4:"ÈúÄË¶ÅÊó∂ÔºöÂêçÂ≠ó„ÄÅÈ¶ñÂ≠óÊØç„ÄÅÊòµÁß∞„ÄÇ",
        how_note:"Mango ‰∏çÊää‰∫§Êç¢ÂèòÊàê‰ø°Áî®ÊàñÂÄ∫Âä°„ÄÇÂÆÉÊòØ‰π¶Èù¢ÊâøËÆ§„ÄÇ",
        btn_home:"È¶ñÈ°µ",
        btn_top:"ÂõûÂà∞È°∂ÈÉ®",

        write_title:"ÂÜô‰∏ãËøô‰∏ÄË°å",
        write_text:"‰∏ÄË°å‰∫∫ÊÄßÁöÑ„ÄÅÂÖ∑‰ΩìÁöÑ„ÄÅÁúüÂÆûÁöÑËÆ∞ÂΩï„ÄÇ",
        write_placeholder:"‰æãÔºöIoana Âê¨ Marco ËØ¥ËØù„ÄÇÔºàÁΩóÈ©¨Ôºå2026Âπ¥2Êúà14Êó•Ôºâ",
        write_hint:"ÁÇπÂáª‚ÄúÂèëÈÄÅÔºà‰øùÁïôÂú®ÁΩëÁ´ôÔºâ‚ÄùÂç≥ÂèØ‰ªÖ‰øùÂ≠òÂú®Êú¨ËÆæÂ§á„ÄÇ‰πãÂêé‰Ω†ÂèØ‰ª•ÈöèÊó∂Â§çÂà∂ÊàñÂà†Èô§„ÄÇ",

        btn_send_keep:"ÂèëÈÄÅÔºà‰øùÁïôÂú®ÁΩëÁ´ôÔºâ",
        btn_clear_field:"Ê∏ÖÁ©∫ËæìÂÖ•",
        btn_copy:"Â§çÂà∂",
        btn_delete_all:"Âà†Èô§ÊâÄÊúâËÆ∞ÂΩï",

        yourlines_title:"‰Ω†ÁöÑËÆ∞ÂΩïÔºà‰ªÖÂú®Êú¨ËÆæÂ§áÔºâ",
        yourlines_text:"Ëøô‰∫õËÆ∞ÂΩï‰∏çÂÖ¨ÂºÄÔºö‰ªÖÂ≠òÂÇ®Âú®‰Ω†ÁöÑÊµèËßàÂô®‰∏≠„ÄÇ",
        empty:"ËøòÊ≤°Êúâ‰øùÂ≠òÁöÑËÆ∞ÂΩï„ÄÇ",

        footer1:"Áî± Juan de Dios Annaloro Mercedes ÂàõÂª∫ ‚Äî 2026Âπ¥2Êúà2Êó• ‚Äî Á∫™Âøµ Larimar„ÄÇ",
        footer2:"ÂèØÂÆûË∑µ‰∏é‰º†ÈÄíÔºå‰ΩÜ‰∏çÂèØË¢´Êã•ÊúâÊàñ‰∏≠ÂøÉÂåñ„ÄÇ"
      }
    };

    // URL lang helpers
    function getLang(){
      const u = new URL(location.href);
      const l = (u.searchParams.get("lang") || "").toLowerCase();
      return SUPPORTED.includes(l) ? l : DEFAULT_LANG;
    }
    function setLang(l){
      const u = new URL(location.href);
      u.searchParams.set("lang", l);
      history.replaceState({}, "", u.toString());
    }
    function withLang(path){
      const l = getLang();
      const hasQ = path.includes("?");
      if(path.includes("lang=")) return path;
      return path + (hasQ ? "&" : "?") + "lang=" + encodeURIComponent(l);
    }

    // Apply translations
    function apply(l){
      document.documentElement.lang = l;
      document.querySelectorAll(".chip").forEach(b=>{
        b.setAttribute("aria-current", b.dataset.lang === l ? "true" : "false");
      });
      const d = T[l] || T[DEFAULT_LANG];

      const map = [
        "title","subtitle",
        "how_title","how_text","how_li1","how_li2","how_li3","how_li4","how_note",
        "btn_home","btn_top",
        "write_title","write_text","write_hint",
        "btn_send_keep","btn_clear_field","btn_copy","btn_delete_all",
        "yourlines_title","yourlines_text","empty",
        "footer1","footer2"
      ];
      map.forEach(k=>{
        const el = document.getElementById("t_"+k);
        if(el) el.textContent = d[k] || "";
      });

      const ta = document.getElementById("lineInput");
      if(ta) ta.placeholder = d.write_placeholder || "";
      const home = document.getElementById("btn_home");
      if(home) home.href = withLang("./index.html");
      document.title = "Mango ‚Äî " + (d.title || "Primo scambio");
    }

    // Storage
    function loadLines(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        const arr = raw ? JSON.parse(raw) : [];
        return Array.isArray(arr) ? arr : [];
      }catch(_){ return []; }
    }
    function saveLines(arr){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }

    // Render list
    function renderLines(){
      const list = document.getElementById("linesList");
      const empty = document.getElementById("t_empty");
      const arr = loadLines();

      list.innerHTML = "";
      if(!arr.length){
        empty.style.display = "block";
        return;
      }
      empty.style.display = "none";

      arr.forEach((item, idx)=>{
        const box = document.createElement("div");
        box.className = "lineItem";

        const meta = document.createElement("div");
        meta.className = "lineMeta";

        const tag = document.createElement("div");
        tag.className = "tag";
        const dt = item && item.ts ? new Date(item.ts) : new Date();
        tag.textContent = dt.toLocaleString();

        const actions = document.createElement("div");
        actions.className = "btnrow";
        actions.style.margin = "0";
        actions.style.gap = "8px";

        const bCopy = document.createElement("button");
        bCopy.className = "btn secondary small";
        bCopy.type = "button";
        bCopy.textContent = "üìã";
        bCopy.title = "Copy";
        bCopy.addEventListener("click", async ()=>{
          const text = (item && item.text ? item.text : "");
          if(!text) return;
          try{ await navigator.clipboard.writeText(text); }
          catch(_){
            const ta = document.getElementById("lineInput");
            if(ta){
              ta.value = text;
              ta.focus();
              ta.select();
              try{ document.execCommand("copy"); }catch(__){}
            }
          }
        });

        const bDel = document.createElement("button");
        bDel.className = "btn secondary small";
        bDel.type = "button";
        bDel.textContent = "üóëÔ∏è";
        bDel.title = "Delete";
        bDel.addEventListener("click", ()=>{
          const arr2 = loadLines();
          arr2.splice(idx, 1);
          saveLines(arr2);
          renderLines();
        });

        actions.appendChild(bCopy);
        actions.appendChild(bDel);

        meta.appendChild(tag);
        meta.appendChild(actions);

        const text = document.createElement("div");
        text.className = "lineText";
        text.textContent = (item && item.text ? item.text : ""); // ‚úÖ NO [object Object]

        box.appendChild(meta);
        box.appendChild(text);
        list.appendChild(box);
      });
    }

    // Scroll helpers
    function goTop(){
      try{ window.scrollTo({top:0,left:0,behavior:"smooth"}); }
      catch(_){ window.scrollTo(0,0); }
    }

    // INIT
    (function init(){
      // language buttons
      document.querySelectorAll(".chip").forEach(b=>{
        b.addEventListener("click", ()=>{
          const l = b.dataset.lang;
          setLang(l);
          apply(l);
        });
      });

      // top buttons
      document.getElementById("mangoTop")?.addEventListener("click", goTop);
      document.getElementById("btn_top")?.addEventListener("click", goTop);

      // actions
      document.getElementById("btn_send_keep")?.addEventListener("click", ()=>{
        const ta = document.getElementById("lineInput");
        const text = (ta?.value || "").trim();
        if(!text) return;
        const arr = loadLines();
        arr.unshift({ text, ts: Date.now() });
        saveLines(arr);
        renderLines();
        if(ta) ta.value = "";
        document.getElementById("yourlines")?.scrollIntoView({behavior:"smooth", block:"start"});
      });

      document.getElementById("btn_clear_field")?.addEventListener("click", ()=>{
        const ta = document.getElementById("lineInput");
        if(ta) ta.value = "";
      });

      document.getElementById("btn_copy_line")?.addEventListener("click", async ()=>{
        const ta = document.getElementById("lineInput");
        const text = (ta?.value || "").trim();
        if(!text) return;
        try{ await navigator.clipboard.writeText(text); }
        catch(_){
          if(ta){
            ta.focus(); ta.select();
            try{ document.execCommand("copy"); }catch(__){}
          }
        }
      });

      document.getElementById("btn_delete_all")?.addEventListener("click", ()=>{
        saveLines([]);
        renderLines();
      });

      const l = getLang();
      apply(l);
      renderLines();
    })();
  </script>
</body>
</html>
