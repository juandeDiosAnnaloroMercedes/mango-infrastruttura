<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mango – Scrivi una riga</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#fdfbf7;
  color:#222;
  padding:80px 20px 40px;
  text-align:center;
}
.langbar{
  position:fixed;
  top:12px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  background:#fff;
  border:1px solid #eee;
  border-radius:14px;
  padding:10px 12px;
  box-shadow:0 10px 30px rgba(0,0,0,.06);
}
.langbar a{
  text-decoration:none;
  font-weight:800;
  font-size:13px;
  padding:6px 10px;
  border-radius:10px;
  color:#111;
}
.langbar a.active{
  background:#111;
  color:#fff;
}
.container{max-width:760px;margin:0 auto;}
h1{font-size:34px;margin:20px 0 12px;}
p{font-size:16px;line-height:1.6;margin:0 auto 18px;max-width:680px;}
textarea{
  width:100%;
  max-width:680px;
  height:120px;
  padding:12px;
  font-size:16px;
  border-radius:12px;
  border:1px solid #ddd;
}
.row{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
  margin-top:14px;
}
button{
  padding:12px 18px;
  border:none;
  border-radius:12px;
  font-weight:900;
  cursor:pointer;
}
.primary{background:#f4a825;color:#fff;}
.primary:hover{background:#e69500;}
.dark{background:#111;color:#fff;}
.danger{background:#b00020;color:#fff;}
.list{
  margin:22px auto 0;
  max-width:680px;
  text-align:left;
  background:#fff;
  border:1px solid #eee;
  border-radius:16px;
  padding:14px 16px;
}
.item{
  padding:10px 0;
  border-bottom:1px solid #f0f0f0;
}
.item:last-child{border-bottom:none;}
.meta{font-size:12px;opacity:.6;margin-bottom:6px;}
</style>
</head>

<body>

<nav class="langbar">
  <a href="?lang=it" data-lang="it">IT</a>
  <a href="?lang=en" data-lang="en">EN</a>
  <a href="?lang=es" data-lang="es">ES</a>
  <a href="?lang=fr" data-lang="fr">FR</a>
  <a href="?lang=de" data-lang="de">DE</a>
  <a href="?lang=zh" data-lang="zh">中文</a>
</nav>

<div class="container">
  <h1 id="title"></h1>
  <p id="desc"></p>

  <textarea id="lineInput" placeholder=""></textarea>

  <div class="row">
    <button class="primary" id="saveBtn"></button>
    <button class="dark" id="copyBtn"></button>
    <button class="danger" id="clearBtn"></button>
  </div>

  <div class="list" id="listBox" style="display:none;">
    <div id="savedList"></div>
  </div>
</div>

<script>
const T = {
  it:{
    title:"Scrivi una riga",
    desc:"Scrivi la riga dello scambio. Nessuna quantità. Nessun valore numerico. La riga viene salvata sul tuo dispositivo (non online).",
    placeholder:"Scrivi qui la tua riga...",
    save:"Salva riga",
    copy:"Copia tutte",
    clear:"Cancella tutto"
  },
  en:{
    title:"Write one line",
    desc:"Write the line of the exchange. No quantities. No numeric value. The line is saved on your device (not online).",
    placeholder:"Write your line here...",
    save:"Save line",
    copy:"Copy all",
    clear:"Delete all"
  },
  es:{
    title:"Escribe una línea",
    desc:"Escribe la línea del intercambio. Sin cantidades. Sin valor numérico. La línea se guarda en tu dispositivo (no en línea).",
    placeholder:"Escribe tu línea aquí...",
    save:"Guardar línea",
    copy:"Copiar todas",
    clear:"Borrar todo"
  },
  fr:{
    title:"Écrire une ligne",
    desc:"Écris la ligne de l’échange. Aucune quantité. Aucune valeur numérique. La ligne est enregistrée sur ton appareil (pas en ligne).",
    placeholder:"Écris ta ligne ici...",
    save:"Enregistrer",
    copy:"Tout copier",
    clear:"Tout supprimer"
  },
  de:{
    title:"Eine Zeile schreiben",
    desc:"Schreibe die Zeile des Austauschs. Keine Mengen. Kein Zahlenwert. Die Zeile wird auf deinem Gerät gespeichert (nicht online).",
    placeholder:"Schreibe deine Zeile hier...",
    save:"Zeile speichern",
    copy:"Alle kopieren",
    clear:"Alles löschen"
  },
  zh:{
    title:"写一行",
    desc:"写下交换的一行内容。没有数量。没有数值。该内容保存在你的设备上（不在线）。",
    placeholder:"在这里写下你的内容...",
    save:"保存",
    copy:"复制全部",
    clear:"全部删除"
  }
};

const params=new URLSearchParams(location.search);
const lang=params.get("lang")||"it";
const t=T[lang]||T.it;

document.documentElement.lang=lang;
document.getElementById("title").textContent=t.title;
document.getElementById("desc").textContent=t.desc;
document.getElementById("lineInput").placeholder=t.placeholder;
document.getElementById("saveBtn").textContent=t.save;
document.getElementById("copyBtn").textContent=t.copy;
document.getElementById("clearBtn").textContent=t.clear;

document.querySelectorAll(".langbar a").forEach(a=>{
  if(a.dataset.lang===lang) a.classList.add("active");
});

const KEY="mango_rows_v2";
const input=document.getElementById("lineInput");
const list=document.getElementById("savedList");
const box=document.getElementById("listBox");

function load(){return JSON.parse(localStorage.getItem(KEY)||"[]");}
function save(rows){localStorage.setItem(KEY,JSON.stringify(rows));}

function render(){
  const rows=load();
  if(!rows.length){box.style.display="none";list.innerHTML="";return;}
  box.style.display="block";
  list.innerHTML=rows.slice().reverse().map(r=>{
    const d=new Date(r.ts);
    return `<div class="item"><div class="meta">${d.toLocaleString()}</div>${r.text}</div>`;
  }).join("");
}

document.getElementById("saveBtn").onclick=function(){
  const text=input.value.trim();
  if(!text)return;
  const rows=load();
  rows.push({ts:Date.now(),text});
  save(rows);
  input.value="";
  render();
};

document.getElementById("copyBtn").onclick=function(){
  const rows=load();
  const txt=rows.map(r=>r.text).join("\n");
  if(!txt)return alert("Nessuna riga salvata");
  navigator.clipboard.writeText(txt);
};

document.getElementById("clearBtn").onclick=function(){
  if(confirm("Cancellare tutto?")){
    localStorage.removeItem(KEY);
    render();
  }
};

render();
</script>

</body>
</html>
